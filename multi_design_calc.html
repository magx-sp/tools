<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>複数デザイン計算ツール</title>
  <link rel="stylesheet" href="style_mdc.css">
</head>
<body>
  <h1>複数デザイン計算ツール（菊半裁最適化対応）<span class="muted">v4</span></h1>

  <div class="toolbar">
    <label>面付数<input type="number" id="facesPerSheet" min="1" step="1" value="100"></label>
    <label>デザイン数<input type="number" id="designCount" min="1" step="1" value="3"></label>
    <button class="btn" id="applyCount">反映</button>
    <label><input type="checkbox" id="magnetMode" checked> 半裁あり</label>
    <span class="spacer"></span>
    <input type="file" id="csvFile" accept=".csv,text/csv" style="display:none;">
    <button class="btn" id="pickCsv">CSV読み込み</button>
    <button class="btn primary" id="exportXlsx">結果をExcel（.xlsx）でエクスポート</button>
  </div>

  <div class="layout">
    <section class="panel">
      <header>入力（<span id="designCountBadge" class="badge">0</span> デザイン）</header>
      <div class="row-compact">
        <button class="btn" id="sampleCsv">サンプルCSV</button>
      </div>
      <div class="dropzone" id="dropzone">ここにCSVをドラッグ＆ドロップ<br><span class="muted">列：デザイン名,数量</span></div>
      <div id="designWrap" style="margin-top:8px;">
        <div id="designGrid" class="grid"></div>
      </div>
      <div class="muted" style="margin-top:6px;">※スクロール可。値を変えると自動で「計算」します。</div>
    </section>

    <section class="panel">
      <header>結果</header>
      <table id="resultTable" style="display:none;">
        <thead>
          <tr id="resultHeader">
            <th>デザイン名</th>
            <th>面付数</th>
            <th>総印刷数</th>
            <th>予備数</th>
            <th>予備率</th>
          </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr><td id="summaryCell" colspan="6" class="right"></td></tr>
        </tfoot>
      </table>
    </section>
  </div>

  <script src="script_mdc.js"></script>
</body>
</html>